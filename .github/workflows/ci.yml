name: Template_repo_CI

on:
  push:
  pull_request:

jobs:
  lint:
    runs-on: ubuntu-latest
    name: Jobs in DevContainer

    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Build DevContainer
        uses: devcontainers/ci@v0.3
        with:
          runCmd: echo "DevContainer built âœ…"

      - name: Run linter and format checks
        uses: devcontainers/ci@v0.3
        with:
          runCmd: |
            echo "ğŸ§¹ Running all linters inside DevContainer..."
            bazel run ruff check /workspaces/template_repo
            bazel run clang_tidy
            bazel run clang_format_check
            bazel run buildifier_check
            echo "âœ… All linters passed!"
      
      - name: Test if build succeeds
        uses: devcontainers/ci@v0.3
        with:
          runCmd: |
            echo "ğŸ› ï¸ Testing if build succeeds inside DevContainer..."
            bazel build //...
            echo "âœ… Build succeeded!"
